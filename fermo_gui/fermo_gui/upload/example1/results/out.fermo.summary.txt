Molecular feature and sample information was parsed from the file 'case_study_peak_table_quant_full.csv' in the format 'mzmine3' with 'positive' ion mode polarity.
MS/MS fragmentation information was parsed from the file 'case_study_MSMS.mgf' in the format 'mgf'. MS/MS fragments +- 10 mass units around precursor m/z were removed.
MS/MS fragments with an intensity less than '0.01' relative to the base peak were removed.
Phenotype/bioactivity information was parsed from the file 'case_study_bioactivity_qualitative.csv' in the format 'qualitative'.
Group metadata information was parsed from the file 'case_study_group_metadata.csv' in the format 'fermo'.
A user-specified spectral library was parsed from the file 'case_study_spectral_library.mgf' in the format 'mgf'.
MS2Query results were parsed from the file 'case_study.ms2query_results.csv'. Only results with a score above a user-specified value of '0.7' were retained.
For each sample, overlapping molecular features were annotated for ion adducts using a cutoff mass deviation value of '10.0' ppm.
For each molecular feature, neutral losses were calculated between the precursor m/z and each MS/MS fragment peak m/z and matched against a library of annotated neutral losses, using a cutoff mass deviation value of '10.0' ppm.
For each molecular feature, MS/MS fragments were matched against a library of annotated MS/MS fragments, using a cutoff mass deviation value of '10.0' ppm.
MS/MS spectra of all molecular features with more than '5' fragment ions were compared pairwise and scored using the 'modified cosine' algorithm, with a fragment tolerance of '0.1'. From the resulting similarity matrix, a network was created, with features represented as nodes and the similarity value as edges. Edges were pruned if their score was below a similarity cutoff of '0.7'. Also, edges were pruned so that only the '10' highest scoring edges remained.
MS/MS spectra of all molecular features with more than '5' fragment ions were compared pairwise and scored using the 'MS2Deepscore' algorithm. From the resulting similarity matrix, a network was created, with features represented as nodes and the similarity value as edges. Edges were pruned if their score was below a similarity cutoff of '0.8'. Also, edges were pruned so that only the '10' highest scoring edges remained.
Molecular features only detected in sample-blanks were considered blank-associated, as were features that had a quotient of less than '10' when their 'mean' 'area' between samples and sample blanks was compared.
Samples were grouped according to the provided group metadata information. For each molecular feature observed in more than one group, the quotient between the 'mean' 'area' of groups was calculated pairwise.
Molecular feature only detected in phenotype-associated samples were considered phenotype-associated, as were feature that had a quotient of higher than '10' when their 'minmax' 'area' between phenotype-associated and not phenotype-associated samples was compared.
The MS/MS spectrum of each molecular feature was matched pairwise against the user-provided spectral library using the 'modified cosine' algorithm, with a fragment tolerance of '0.1'. Matches were only retained if the number of matched peaks between feature and library spectrum was greater than '5', the score exceeded the cutoff score of '0.7', and the maximum precursor m/z difference of '600' was not exceeded.
The MS/MS spectrum of each molecular feature was matched pairwise against the user-provided spectral library using the 'MS2DeepScore' algorithm. Matches were only retained if the score exceeded the cutoff score of '0.8', and the maximum precursor m/z difference of '600' was not exceeded.